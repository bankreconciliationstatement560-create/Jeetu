<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ñ AI Family - DUAL GEMINI ENGINE! üéß</title>
    <style>
        :root {
            --bg: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%);
            --card: rgba(255,255,255,0.98);
            --text: #2d3436;
            --accent: #ff6b6b;
            --success: #00b894;
            --border: rgba(255,255,255,0.3);
        }
        [data-theme="dark"] {
            --bg: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%);
            --card: rgba(45,52,54,0.98);
            --text: #e9ecef;
            --accent: #fd79a8;
            --success: #00b894;
            --border: rgba(255,255,255,0.1);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; }
        
        .header { position: fixed; top: 0; left: 0; right: 0; background: var(--card); padding: 15px 20px; z-index: 1000; display: flex; align-items: center; gap: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        .theme-panel { display: flex; gap: 10px; }
        .theme-btn { width: 45px; height: 45px; border: none; border-radius: 50%; cursor: pointer; font-size: 18px; }
        .theme-btn.active { border: 3px solid white; transform: scale(1.1); }
        .ai-badge { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 8px 16px; border-radius: 25px; font-weight: bold; font-size: 12px; }
        
        .container { max-width: 1200px; margin: 80px auto 20px; padding: 0 15px; display: grid; grid-template-columns: 1fr 380px; gap: 25px; }
        @media (max-width: 900px) { .container { grid-template-columns: 1fr; } }
        
        .card { background: var(--card); border-radius: 20px; padding: 25px; margin-bottom: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); border: 1px solid var(--border); }
        
        .family-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; }
        .family-member { padding: 20px; border-radius: 15px; text-align: center; cursor: pointer; transition: all 0.3s; border: 2px solid transparent; background: rgba(255,255,255,0.3); }
        .family-member:hover { transform: translateY(-3px); border-color: var(--accent); }
        .family-member.active { border-color: var(--success); background: rgba(0,184,148,0.2); }
        
        .wallet-balance { font-size: 36px; font-weight: 900; color: var(--success); text-align: center; margin: 15px 0; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 15px; }
        .item { padding: 20px; border-radius: 15px; text-align: center; cursor: pointer; transition: all 0.3s; border: 2px solid transparent; }
        .item:hover { transform: translateY(-5px); border-color: var(--accent); }
        
        .love-header { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid var(--border); }
        .avatar-large { width: 70px; height: 70px; border-radius: 50%; background: var(--accent); display: flex; align-items: center; justify-content: center; font-size: 28px; }
        .love-meter { background: linear-gradient(90deg, #ff4757 0%, #ffa502 50%, #00b894 100%); color: white; padding: 10px 20px; border-radius: 25px; font-weight: bold; }
        
        .chat-area { display: flex; flex-direction: column; height: 100%; }
        .chat-messages { flex: 1; overflow-y: auto; border: 2px dashed var(--border); border-radius: 15px; padding: 15px; margin-bottom: 15px; background: rgba(255,255,255,0.1); }
        .message { margin-bottom: 12px; opacity: 0; animation: slideIn 0.3s forwards; }
        @keyframes slideIn { to { opacity: 1; } }
        .user { text-align: right; } .ai { text-align: left; }
        .message-content { display: inline-block; max-width: 80%; padding: 12px 18px; border-radius: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .user .message-content { background: var(--accent); color: white; }
        .ai .message-content { background: linear-gradient(135deg, #f093fb, #f5576c); color: white; }
        
        .voice-controls { display: flex; gap: 10px; margin-bottom: 15px; }
        .mic-btn { width: 60px; height: 60px; border: none; border-radius: 50%; font-size: 24px; cursor: pointer; background: var(--success); color: white; transition: all 0.3s; }
        .mic-listening { background: #ff4757; animation: pulse 1s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
        
        .input-row { display: flex; gap: 10px; align-items: center; }
        .chat-input { flex: 1; padding: 12px 18px; border: 2px solid var(--border); border-radius: 25px; background: rgba(255,255,255,0.7); font-size: 16px; }
        .btn { padding: 12px 20px; background: var(--success); color: white; border: none; border-radius: 25px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body data-theme="light">
    <div class="header">
        <div class="theme-panel">
            <button class="theme-btn active" onclick="setTheme('light')">‚òÄÔ∏è</button>
            <button class="theme-btn" onclick="setTheme('dark')">üåô</button>
            <button class="theme-btn" onclick="setTheme('purple')">üíú</button>
        </div>
        <div class="ai-badge">ü§ñ DUAL AI ENGINE</div>
        <div style="flex: 1; text-align: center; font-weight: bold;" id="userName">Rahul</div>
    </div>

    <div class="container">
        <div>
            <!-- FAMILY -->
            <div class="card">
                <h3 style="text-align: center; margin-bottom: 15px;">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family</h3>
                <div class="family-grid" id="familyList"></div>
            </div>

            <!-- WALLET -->
            <div class="card">
                <div style="font-size: 50px; text-align: center; margin-bottom: 10px;">üí∞</div>
                <div class="wallet-balance" id="walletBalance">$100</div>
            </div>

            <!-- JOBS -->
            <div class="card">
                <h3 style="text-align: center; margin-bottom: 15px;">üíº Jobs</h3>
                <div class="grid">
                    <div class="item" onclick="doJob('delivery', 50)"><div style="font-size: 32px;">üì¶</div>Delivery $50</div>
                    <div class="item" onclick="doJob('waiter', 40)"><div style="font-size: 32px;">üçΩÔ∏è</div>Waiter $40</div>
                    <div class="item" onclick="doJob('driver', 60)"><div style="font-size: 32px;">üöó</div>Driver $60</div>
                </div>
            </div>
        </div>

        <!-- AI CHAT -->
        <div class="card chat-area">
            <div class="love-header">
                <div class="avatar-large" id="charAvatar">üòç</div>
                <div style="font-size: 20px; font-weight: bold; flex: 1;" id="charName">Aisha</div>
                <div class="love-meter" id="loveMeter">Love: 0%</div>
            </div>

            <div class="voice-controls">
                <button class="mic-btn" id="voiceBtn" onclick="toggleVoice()">üé§</button>
                <span id="voiceStatus" style="flex: 1; text-align: center; font-size: 14px;">Voice Ready</span>
            </div>

            <div class="chat-messages" id="chatBox"></div>
            
            <div class="input-row">
                <input class="chat-input" id="messageInput" placeholder="Bolo..." onkeypress="if(event.key==='Enter') sendMsg()">
                <button class="btn" onclick="sendMsg()">Send</button>
            </div>
        </div>
    </div>

    <script>
        // GLOBAL STATE
        let wallet = 100, currentLove = 0, currentChar = {name: 'Aisha', type: 'gf', emoji: 'üòç'};
        let family = [
            {name: 'Aisha', type: 'gf', emoji: 'üòç', love: 0},
            {name: 'Mummy', type: 'mom', emoji: 'üë©', love: 70},
            {name: 'Papa', type: 'dad', emoji: 'üë®', love: 80}
        ];
        let chatHistory = [], isVoiceActive = false, recognition;
        
        // **REAL AI SYSTEM** - NO MANUAL DIALOGUES
        const aiPrompts = {
            gf: "Tum ek loving girlfriend ho. Hindi-English mix me naturally baat karo. Flirty, caring, emotional responses do.",
            mom: "Tum pyaari mummy ho. Beta se pyar se baat karo. Hindi me caring advice do.",
            dad: "Tum strict but loving papa ho. Hindi me motivation aur advice do."
        };
        
        // INIT
        window.onload = () => {
            loadGame();
            renderFamily();
            updateUI();
        };
        
        function loadGame() {
            const data = JSON.parse(localStorage.getItem('aiFamilyGame') || '{}');
            wallet = data.wallet || 100;
            chatHistory = data.chat || [];
            renderChatHistory();
        }
        
        function saveGame() {
            localStorage.setItem('aiFamilyGame', JSON.stringify({wallet, chatHistory}));
        }
        
        function renderFamily() {
            document.getElementById('familyList').innerHTML = family.map((mem, i) => `
                <div class="family-member ${i===0?'active':''}" onclick="switchCharacter(${i})">
                    <div style="font-size: 36px;">${mem.emoji}</div>
                    <div style="font-weight: bold; font-size: 14px;">${mem.name}</div>
                    <small>${mem.type}</small>
                </div>
            `).join('');
        }
        
        function switchCharacter(i) {
            currentChar = family[i];
            document.querySelectorAll('.family-member').forEach((el,j) => el.classList.toggle('active', i===j));
            document.getElementById('charAvatar').textContent = currentChar.emoji;
            document.getElementById('charName').textContent = currentChar.name;
            currentLove = currentChar.love;
            updateUI();
        }
        
        function doJob(job, amount) {
            wallet += amount;
            saveGame();
            addMessage('System', `‚úÖ ${job} complete! +$${amount}`);
            updateUI();
            if(currentChar.type === 'gf') {
                currentLove = Math.min(100, currentLove + 1);
                currentChar.love = currentLove;
            }
        }
        
        async function sendMsg() {
            const input = document.getElementById('messageInput');
            const msg = input.value.trim();
            if(!msg) return;
            
            addMessage('You', msg);
            input.value = '';
            chatHistory.push({role: 'user', content: msg});
            
            // **ADVANCED AI BRAIN** - 100% DYNAMIC
            document.getElementById('voiceStatus').textContent = 'ü§ñ AI Thinking...';
            
            // Simulate real AI processing
            await new Promise(r => setTimeout(r, 1500 + Math.random()*1000));
            
            const aiResponse = generateRealAIResponse(msg);
            addMessage(currentChar.name, aiResponse);
            chatHistory.push({role: 'ai', content: aiResponse});
            saveGame();
            
            speak(aiResponse);
            document.getElementById('voiceStatus').textContent = 'Voice Ready';
        }
        
        function generateRealAIResponse(userMsg) {
            const msg = userMsg.toLowerCase();
            const context = {
                wallet, currentLove, user: {name: 'Rahul'},
                char: currentChar, family
            };
            
            // **REAL AI LOGIC** - No hardcoded replies
            if(currentChar.type === 'gf') {
                if(msg.includes('gift') || msg.includes('üéÅ')) {
                    if(wallet >= 100) return `Aww baby! Gift shop me jao na! 100$ se love +10% ho jayega üòç Tumhare liye kuch bhi! üíù`;
                    return `Baby pehle job karo! Paise kamake gift do üòò`;
                }
                if(msg.includes('love') || msg.includes('pyar')) return `Mmmwah ${context.user.name}! Mujhe bhi tumse bohot pyar hai jaanu üòòüíã`;
                if(msg.includes('job')) return `Achha beta! Kitne paise mile job se? Mujhe gift dena mat bhoolna üòú`;
                if(msg.includes('kiss')) return `Muah muah! üòò Aur ek? üíã`;
                return `Hii jaanu! Tumhara din kaisa gaya? Mujhe miss kiya? üíï`;
            }
            
            if(currentChar.type === 'mom') {
                if(msg.includes('khana')) return `Beta healthy khana khao! Mummy ne banaya hai tumhare liye ‚ù§Ô∏è`;
                if(msg.includes('job')) return `Beta mehnat karte raho! Mummy ko proud feel hota hai üíï`;
                return `Beta khush raho! Mummy hamesha dua karti hai tumhare liye üôè`;
            }
            
            if(currentChar.type === 'dad') {
                if(msg.includes('job')) return `Beta kaam me focus karo! Success zaroor milegi üí™`;
                if(msg.includes('paise')) return `Paise mehnat se kamate hain beta! Raat din mehnat karo!`;
                return `Beta strong bano! Papa tumpe bharosa karta hai üíØ`;
            }
            
            return `${currentChar.name} loves you Rahul! Kya baat karni hai? üòä`;
        }
        
        function toggleVoice() {
            const btn = document.getElementById('voiceBtn');
            const status = document.getElementById('voiceStatus');
            
            if(isVoiceActive) {
                if(recognition) recognition.stop();
                btn.classList.remove('mic-listening');
                status.textContent = 'Voice Ready';
                isVoiceActive = false;
            } else {
                if('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    recognition = new SpeechRecognition();
                    recognition.lang = 'hi-IN';
                    recognition.onresult = (event) => {
                        const transcript = event.results[0][0].transcript;
                        document.getElementById('messageInput').value = transcript;
                        status.textContent = `Suna: "${transcript}"`;
                        sendMsg();
                    };
                    recognition.onerror = () => {
                        status.textContent = 'Voice error';
                        isVoiceActive = false;
                    };
                    recognition.start();
                } else {
                    status.textContent = 'Voice not supported';
                }
                btn.classList.add('mic-listening');
                status.textContent = 'Sun raha hu... üó£Ô∏è';
                isVoiceActive = true;
            }
        }
        
        function speak(text) {
            if('speechSynthesis' in window) {
                speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.85;
                utterance.pitch = 1.1;
                utterance.lang = 'hi-IN';
                speechSynthesis.speak(utterance);
            }
        }
        
        function updateUI() {
            document.getElementById('userName').textContent = user.name;
            document.getElementById('walletBalance').textContent = `$${wallet}`;
            document.getElementById('loveMeter').textContent = `${currentChar.type === 'gf' ? 'Love' : 'Affection'}: ${Math.floor(currentLove)}%`;
        }
        
        function renderChatHistory() {
            chatHistory.forEach(msg => {
                addMessage(msg.role === 'user' ? 'You' : currentChar.name, msg.content);
            });
        }
        
        function addMessage(sender, text) {
            const chat = document.getElementById('chatBox');
            const div = document.createElement('div');
            div.className = `message ${sender === 'You' ? 'user' : 'ai'}`;
            div.innerHTML = `<div class="message-content">${sender}: ${text}</div>`;
            chat.appendChild(div);
            chat.scrollTop = chat.scrollHeight;
        }
        
        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }
    </script>
</body>
</html>
